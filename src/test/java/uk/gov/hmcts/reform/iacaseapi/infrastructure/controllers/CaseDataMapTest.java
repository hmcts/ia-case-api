package uk.gov.hmcts.reform.iacaseapi.infrastructure.controllers;

import static org.assertj.core.api.Assertions.assertThat;

import com.fasterxml.jackson.databind.ObjectMapper;
import java.io.IOException;
import java.util.List;
import java.util.Optional;
import org.junit.Test;
import uk.gov.hmcts.reform.iacaseapi.domain.entities.CaseDataMap;
import uk.gov.hmcts.reform.iacaseapi.domain.entities.DocumentWithDescription;
import uk.gov.hmcts.reform.iacaseapi.domain.entities.ccd.field.IdValue;

public class CaseDataMapTest {

    private final String caseData = "{\"appealType\": \"protection\", \"directions\": [{\"id\": \"5\", \"value\": {\"tag\": \"legalRepresentativeHearingRequirements\", \"dateDue\": \"2019-05-07\", \"parties\": \"legalRepresentative\", \"dateSent\": \"2019-05-02\", \"explanation\": \"Your appeal is going to a hearing. Login to submit your hearing requirements on the overview tab.\\n\\nNext steps\\nThe case officer will review your hearing requirements and try to accommodate them. You will then be sent a hearing date.\\nIf you do not supply your hearing requirements within 5 days, we may not be able to accommodate your needs for the hearing.\\n\"}}, {\"id\": \"4\", \"value\": {\"tag\": \"legalRepresentativeReview\", \"dateDue\": \"2019-05-07\", \"parties\": \"legalRepresentative\", \"dateSent\": \"2019-05-02\", \"explanation\": \"The respondent has replied to your appeal argument and evidence. You must now review their response.\\n\\nNext steps\\nYou have 5 days to review the response. If you want to respond to what the Home Office has said, you should email the case officer.\\n\\nIf you do not respond within 5 days, the case will automatically go to hearing.\"}}, {\"id\": \"3\", \"value\": {\"tag\": \"respondentReview\", \"dateDue\": \"2019-05-16\", \"parties\": \"respondent\", \"dateSent\": \"2019-05-02\", \"explanation\": \"You must now review this case.\\n\\nYou have 14 days to review the appeal argument and evidence. You must explain whether the appellant's appeal argument makes a valid case for overturning the original protection decision.\\n\\nYou must respond to the case officer and tell them:\\n- whether you oppose all or part of the appellant's case\\n- what your grounds are for opposing the case\\n- which of the issues are agreed or not agreed\\n- whether there are any further issues you wish to raise\\n- whether you are prepared to withdraw to grant or reconsider\\n- whether the appeal can be resolved without a hearing\\n\\nYou may find it helpful to use the response template provided.\\n\\nNext steps\\n\\nIf you do not respond in time, the case officer will decide how the case should proceed.\"}}, {\"id\": \"2\", \"value\": {\"tag\": \"buildCase\", \"dateDue\": \"2019-05-30\", \"parties\": \"legalRepresentative\", \"dateSent\": \"2019-05-02\", \"explanation\": \"You must now build your case by uploading your appeal argument and evidence.\\n\\nAdvice on writing an appeal argument\\nYou must write a full argument that references:\\n- all the evidence you have or plan to rely on, including any witness statements\\n- the grounds and issues of the case\\n- any new matters\\n- any legal authorities you plan to rely on and why they are applicable to your case\\n\\nYour argument must explain why you believe the respondent's decision is wrong. You must provide all the information for the Home Office to conduct a thorough review of their decision at this stage.\\n\\nNext steps\\nOnce you have uploaded your appeal argument and all evidence, submit your case. The case officer will then review everything you've added. If your case looks ready, the case officer will send it to the respondent for their review. The respondent then has 14 days to respond.\"}}, {\"id\": \"1\", \"value\": {\"tag\": \"respondentEvidence\", \"dateDue\": \"2019-05-16\", \"parties\": \"respondent\", \"dateSent\": \"2019-05-02\", \"explanation\": \"A notice of appeal has been lodged against this asylum decision.\\n\\nYou must now send all documents to the case officer. The case officer will send them to the other party. You have 14 days to supply these documents.\\n\\nYou must include:\\n- the notice of decision\\n- any other document provided to the appellant giving reasons for that decision\\n- any statements of evidence\\n- the application form\\n- any record of interview with the appellant in relation to the decision being appealed\\n- any other unpublished documents on which you rely\\n- the notice of any other appealable decision made in relation to the appellant\"}}], \"newMatters\": \"Birth of a child\", \"hasNewMatters\": \"Yes\", \"hearingCentre\": \"taylorHouse\", \"appellantTitle\": \"Mr\", \"hasOtherAppeals\": \"No\", \"hearingDocuments\": [{\"id\": \"1\", \"value\": {\"tag\": \"caseSummary\", \"document\": {\"document_url\": \"http://dm-store:8080/documents/7d3d373f-cc89-460e-88a5-cecb608dc009\", \"document_filename\": \"CaseSummary.pdf\", \"document_binary_url\": \"http://dm-store:8080/documents/7d3d373f-cc89-460e-88a5-cecb608dc009/binary\"}, \"description\": \"This is the case summary\", \"dateUploaded\": \"2019-05-02\"}}], \"notificationsSent\": [{\"id\": \"1556785958668800_APPEAL_SUBMITTED_CASE_OFFICER\", \"value\": \"9ba645ff-a18d-4fb0-be98-7d32da9e63f3\"}, {\"id\": \"1556785958668800_RESPONDENT_EVIDENCE_DIRECTION\", \"value\": \"9e9f4b5f-1e58-4450-86ad-23310269d3a7\"}, {\"id\": \"1556785958668800_BUILD_CASE_DIRECTION\", \"value\": \"f4ceb63e-998e-49e3-bbfd-025859678b9b\"}, {\"id\": \"1556785958668800_RESPONDENT_REVIEW_DIRECTION\", \"value\": \"f379efec-899b-4066-9519-42986ee18a64\"}, {\"id\": \"1556785958668800_LEGAL_REPRESENTATIVE_REVIEW_DIRECTION\", \"value\": \"be34b549-a977-46e8-a6dc-a21a1a413646\"}, {\"id\": \"1556785958668800_LEGAL_REPRESENTATIVE_HEARING_REQUIREMENTS_DIRECTION\", \"value\": \"34709ed2-3e57-4382-a086-3c40cca99456\"}], \"appellantFamilyName\": \"González\", \"appellantGivenNames\": \"José\", \"caseSummaryDocument\": {\"document_url\": \"http://dm-store:8080/documents/7d3d373f-cc89-460e-88a5-cecb608dc009\", \"document_filename\": \"CaseSummary.pdf\", \"document_binary_url\": \"http://dm-store:8080/documents/7d3d373f-cc89-460e-88a5-cecb608dc009/binary\"}, \"listCaseHearingDate\": \"2019-05-16T10:30:00.000\", \"respondentDocuments\": [{\"id\": \"3\", \"value\": {\"tag\": \"appealResponse\", \"document\": {\"document_url\": \"http://dm-store:8080/documents/a0bf3ff6-488e-4c04-a58c-fb82431703b0\", \"document_filename\": \"AppealResponse.pdf\", \"document_binary_url\": \"http://dm-store:8080/documents/a0bf3ff6-488e-4c04-a58c-fb82431703b0/binary\"}, \"description\": \"This is the appeal response\", \"dateUploaded\": \"2019-05-02\"}}, {\"id\": \"2\", \"value\": {\"tag\": \"appealResponse\", \"document\": {\"document_url\": \"http://dm-store:8080/documents/8ee759f4-73e5-4824-bc02-af2b6429089c\", \"document_filename\": \"AppealResponseEvidence.pdf\", \"document_binary_url\": \"http://dm-store:8080/documents/8ee759f4-73e5-4824-bc02-af2b6429089c/binary\"}, \"description\": \"This is the appeal response evidence\", \"dateUploaded\": \"2019-05-02\"}}, {\"id\": \"1\", \"value\": {\"tag\": \"respondentEvidence\", \"document\": {\"document_url\": \"http://dm-store:8080/documents/8561e00f-afa2-4a58-a307-75464ac1c88c\", \"document_filename\": \"RespondentEvidence.pdf\", \"document_binary_url\": \"http://dm-store:8080/documents/8561e00f-afa2-4a58-a307-75464ac1c88c/binary\"}, \"description\": \"This is the respondent evidence\", \"dateUploaded\": \"2019-05-02\"}}], \"submissionOutOfTime\": \"No\", \"appellantDateOfBirth\": \"1999-12-31\", \"caseArgumentDocument\": {\"document_url\": \"http://dm-store:8080/documents/248fcef2-1729-435c-b6df-7f2a1ddd7bf6\", \"document_filename\": \"CaseArgument.pdf\", \"document_binary_url\": \"http://dm-store:8080/documents/248fcef2-1729-435c-b6df-7f2a1ddd7bf6/binary\"}, \"caseArgumentEvidence\": [{\"id\": \"0bb4f5d1-9d5a-46e0-85b8-6d6b997848da\", \"value\": {\"document\": {\"document_url\": \"http://dm-store:8080/documents/801b1cfd-c9c7-4919-8442-e10d7c24b208\", \"document_filename\": \"CaseArgumentEvidence.pdf\", \"document_binary_url\": \"http://dm-store:8080/documents/801b1cfd-c9c7-4919-8442-e10d7c24b208/binary\"}, \"description\": \"The is the case argument evidence\"}}], \"appealReferenceNumber\": \"PA/50199/2019\", \"caseArgumentAvailable\": \"Yes\", \"listCaseHearingCentre\": \"taylorHouse\", \"listCaseHearingLength\": \"360\", \"appealResponseDocument\": {\"document_url\": \"http://dm-store:8080/documents/a0bf3ff6-488e-4c04-a58c-fb82431703b0\", \"document_filename\": \"AppealResponse.pdf\", \"document_binary_url\": \"http://dm-store:8080/documents/a0bf3ff6-488e-4c04-a58c-fb82431703b0/binary\"}, \"appealResponseEvidence\": [{\"id\": \"643de8d6-6bc2-4e5d-b792-1ea1caf32322\", \"value\": {\"document\": {\"document_url\": \"http://dm-store:8080/documents/8ee759f4-73e5-4824-bc02-af2b6429089c\", \"document_filename\": \"AppealResponseEvidence.pdf\", \"document_binary_url\": \"http://dm-store:8080/documents/8ee759f4-73e5-4824-bc02-af2b6429089c/binary\"}, \"description\": \"This is the appeal response evidence\"}}], \"appellantNationalities\": [{\"id\": \"06255b05-ded2-4e65-bb06-d2947f1f3f5f\", \"value\": {\"code\": \"FI\"}}], \"caseSummaryDescription\": \"This is the case summary\", \"homeOfficeDecisionDate\": \"2019-05-02\", \"appealGroundsForDisplay\": [\"protectionRefugeeConvention\"], \"appealGroundsProtection\": {\"values\": [\"protectionRefugeeConvention\"]}, \"appealResponseAvailable\": \"Yes\", \"appellantNameForDisplay\": \"José González\", \"caseArgumentDescription\": \"This is the case argument\", \"legalRepReferenceNumber\": \"some-ref\", \"legalRepresentativeName\": \"A Legal Rep\", \"appealGroundsHumanRights\": {\"values\": []}, \"appellantHasFixedAddress\": \"No\", \"appealResponseDescription\": \"This is the appeal response\", \"homeOfficeReferenceNumber\": \"A123456\", \"legalRepresentativeDocuments\": [{\"id\": \"2\", \"value\": {\"tag\": \"caseArgument\", \"document\": {\"document_url\": \"http://dm-store:8080/documents/248fcef2-1729-435c-b6df-7f2a1ddd7bf6\", \"document_filename\": \"CaseArgument.pdf\", \"document_binary_url\": \"http://dm-store:8080/documents/248fcef2-1729-435c-b6df-7f2a1ddd7bf6/binary\"}, \"description\": \"This is the case argument\", \"dateUploaded\": \"2019-05-02\"}}, {\"id\": \"1\", \"value\": {\"tag\": \"caseArgument\", \"document\": {\"document_url\": \"http://dm-store:8080/documents/801b1cfd-c9c7-4919-8442-e10d7c24b208\", \"document_filename\": \"CaseArgumentEvidence.pdf\", \"document_binary_url\": \"http://dm-store:8080/documents/801b1cfd-c9c7-4919-8442-e10d7c24b208/binary\"}, \"description\": \"The is the case argument evidence\", \"dateUploaded\": \"2019-05-02\"}}], \"sendDirectionActionAvailable\": \"Yes\", \"legalRepresentativeEmailAddress\": \"ia-law-firm-a@fake.hmcts.net\", \"currentCaseStateVisibleToCaseOfficer\": \"finalBundling\", \"changeDirectionDueDateActionAvailable\": \"Yes\", \"uploadAdditionalEvidenceActionAvailable\": \"No\", \"currentCaseStateVisibleToLegalRepresentative\": \"finalBundling\"}";
    private final ObjectMapper objectMapper = new ObjectMapper();

    @Test
    public void testCaseDataSimpleMap() throws IOException {

        CaseDataMap caseDataMap = objectMapper.readValue(caseData, CaseDataMap.class);

        assertThat(caseDataMap.getAppellantGivenNames().get()).isEqualTo("José");
    }

    @Test
    public void testCaseDataComplexMap() throws IOException {

        CaseDataMap caseDataMap = objectMapper.readValue(caseData, CaseDataMap.class);

        Optional<List<IdValue<DocumentWithDescription>>> appealGroundsProtection = caseDataMap.getRespondentEvidence();

        System.out.println();
    }
}